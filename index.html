<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload to JSON</title>
</head>
<body>
    <h1>Upload Files to Save as JSON</h1>
    <form id="file-form">
        <label for="files">Choose files (images, text, or Excel):</label>
        <input type="file" id="files" name="files" multiple accept=".txt,.xlsx,.xls,.jpg,.jpeg,.png,.gif">
        <button type="button" id="upload-button">Upload and Save</button>
    </form>

    <pre id="output"></pre>

    <script>
        document.getElementById('upload-button').addEventListener('click', async () => {
            const fileInput = document.getElementById('files');
            const output = document.getElementById('output');
            const files = fileInput.files;

            if (files.length === 0) {
                alert('Please select at least one file.');
                return;
            }

            const fileData = [];

            for (const file of files) {
                const fileContent = await readFileAsText(file);
                fileData.push({
                    name: file.name,
                    type: file.type,
                    size: file.size,
                    content: fileContent
                });
            }

            const jsonData = JSON.stringify(fileData, null, 2);

            // Display JSON data in the <pre> element
            output.textContent = jsonData;

            // Optionally, download the JSON file
            const blob = new Blob([jsonData], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'files.json';
            link.click();
        });

        // Function to read file as text
        function readFileAsText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();

                if (file.type.includes('image')) {
                    // Read image as a Base64 string
                    reader.readAsDataURL(file);
                } else {
                    reader.readAsText(file);
                }

                reader.onload = () => resolve(reader.result);
                reader.onerror = (error) => reject(error);
            });
        }
    </script>
</body>
</html>
