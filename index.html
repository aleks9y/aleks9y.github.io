<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiniApp</title>
</head>
<body>
    <h1>MiniApp Form</h1>
    <form id="miniapp-form">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" placeholder="Enter your name" required>
        <br><br>

        <label for="about">About Yourself:</label>
        <textarea id="about" name="about" placeholder="Write something about yourself" required></textarea>
        <br><br>

        <label for="files">Upload Files:</label>
        <input type="file" id="files" name="files" multiple>
        <br><br>

        <button type="button" id="submit-button">Submit</button>
    </form>

    <script>
        // Получаем ссылку на кнопку и форму
        const submitButton = document.getElementById('submit-button');
        const form = document.getElementById('miniapp-form');

        submitButton.addEventListener('click', () => {
            // Собираем данные из формы
            const name = document.getElementById('name').value;
            const about = document.getElementById('about').value;
            const files = document.getElementById('files').files;

            // Формируем JSON-объект
            const formData = {
                name: name,
                about: about,
                files: []
            };

            // Добавляем имена файлов в JSON
            for (const file of files) {
                formData.files.push(file.name);
            }

            // Проверяем, что Telegram WebApp доступен
            if (window.Telegram.WebApp) {
                // Отправляем данные в Telegram
                Telegram.WebApp.sendData(JSON.stringify(formData));
            } else {
                alert("Telegram WebApp не инициализирован!");
            }
        });

        // Запускаем WebApp при загрузке
        Telegram.WebApp.ready();
    </script>
</body>
</html>
